(this["webpackJsonpmanga-tracker"]=this["webpackJsonpmanga-tracker"]||[]).push([[0],{67:function(t,e,n){"use strict";n.r(e);var c=n(0),a=n(30),r=n.n(a),i=n(33),s=n(8),o=n(11),l=n.n(o),j=n(7),u=function(t){var e=Object(c.useState)(""),n=Object(s.a)(e,2),a=n[0],r=n[1];return{type:t,value:a,onChange:function(t){r(t.target.value)},onSubmit:function(){r("")}}},d=function(){var t=JSON.parse(localStorage.getItem("loggedInUser"));return{headers:{Authorization:"bearer ".concat(t.token)}}},b=function(t){var e=new Date,n=new Date(t).getTime(),c=(e.getTime()-n)/1e3;return c<60?"just now":c<3600?"".concat(Math.floor(c/60)," minute(s) ago"):c<86400?"".concat(Math.floor(c/3600)," hour(s) ago"):c<2592e3?"".concat(Math.floor(c/86400)," day(s) ago"):c<31104e3?"".concat(Math.floor(c/2592e3)," month(s) ago"):"".concat(Math.floor(c/31104e3)," year(s) ago")},h=n(70),O=n(1),x={textAlign:"center"},f=function(t){var e=Object(c.useState)(""),n=Object(s.a)(e,2),a=n[0],r=n[1],i=Object(c.useState)(!1),o=Object(s.a)(i,2),f=o[0],p=o[1],g=Object(c.useState)(!1),v=Object(s.a)(g,2),m=v[0],S=v[1],C=u("text"),k=u("text"),w="http://localhost:3001/api/manga";Object(c.useEffect)((function(){r(a||t.manga)}),[t,a]);var y=d(),U=function(e){if(e.preventDefault(),"<"===e.target.outerText){var n=Object(j.a)(Object(j.a)({},a),{},{chapter:a.chapter-=1});r(n),l.a.put(w,n,y).then((function(e){r(e.data),t.alert("".concat(e.data.title," moved to previous chapter"))})).catch((function(e){t.alert("Error: ".concat(e))}))}else if(">"===e.target.outerText){var c=Object(j.a)(Object(j.a)({},a),{},{chapter:a.chapter+=1,lastRead:new Date});r(c),l.a.put(w,c,y).then((function(e){r(e.data),t.alert("".concat(e.data.title," moved to next chapter"))})).catch((function(e){t.alert("Error: ".concat(e))}))}},D=function(t){t.preventDefault(),p(!f)},T=function(t){t.preventDefault(),S(!m)};return Object(O.jsxs)("tr",{style:x,children:[Object(O.jsx)("td",{children:a.title||"none"}),Object(O.jsx)("td",{children:b(a.lastRead)}),Object(O.jsxs)("td",{children:[Object(O.jsx)(h.a,{onClick:U,children:"<"}),"\xa0",a.chapter,"\xa0",Object(O.jsx)(h.a,{onClick:U,children:">"})]}),Object(O.jsx)("td",{children:f?Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=Object(j.a)(Object(j.a)({},a),{},{link:C.value});l.a.put(w,n,y).then((function(e){r(e.data),C.onSubmit(),p(!f),t.alert("Changed link for ".concat(a.title))})).catch((function(e){t.alert("Error: ".concat(e))}))},children:["link: ",Object(O.jsx)("input",Object(j.a)({},C)),Object(O.jsx)(h.a,{type:"submit",children:"Update"}),Object(O.jsx)(h.a,{onClick:D,children:"Cancel"})]})}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("a",{href:String(a.link),children:"Go"}),Object(O.jsx)(h.a,{onClick:D,children:"Update"})]})}),Object(O.jsx)("td",{children:m?Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=Object(j.a)(Object(j.a)({},a),{},{notes:k.value});l.a.put(w,n,y).then((function(e){r(e.data),k.onSubmit(),S(!m),t.alert("Updated notes for ".concat(a.title))})).catch((function(e){t.alert("Error: ".concat(e))}))},children:[Object(O.jsx)("input",{type:k.type,onChange:k.onChange,onSubmit:k.onSubmit,defaultValue:a.notes}),Object(O.jsx)(h.a,{type:"submit",children:"Update"}),Object(O.jsx)(h.a,{onClick:T,children:"Cancel"})]})}):Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("p",{children:[a.notes,Object(O.jsx)(h.a,{onClick:T,children:"Update"})]})})}),Object(O.jsx)("td",{children:Object(O.jsxs)("select",{onChange:function(e){if(e.preventDefault(),window.confirm("Are you sure you want to mark ".concat(a.title," as ").concat(e.target.value))){var n=Object(j.a)(Object(j.a)({},a),{},{status:e.target.value});l.a.put(w,n,y).then((function(n){r(n.data),t.alert("Setting ".concat(a.title," status to ").concat(e.target.value))})).catch((function(e){t.alert("Error: ".concat(e))}))}},children:[Object(O.jsx)("option",{value:a.status,children:a.status}),"reading"===a.status?null:Object(O.jsx)("option",{value:"reading",children:"reading"}),"finished"===a.status?null:Object(O.jsx)("option",{value:"finished",children:"finished"}),"to start"===a.status?null:Object(O.jsx)("option",{value:"to start",children:"to start"}),"on hold"===a.status?null:Object(O.jsx)("option",{value:"on hold",children:"on hold"})]})})]})},p=n(69),g=function(t){var e=t.add,n=Object(c.useState)(!1),a=Object(s.a)(n,2),r=a[0],i=a[1],o=u("text"),l=u("text"),d=function(){return Object(O.jsx)(h.a,{onClick:function(t){t.preventDefault(),i(!r)},children:r?"Close":"Add Manga"})};return Object(O.jsxs)("div",{children:[Object(O.jsx)(d,{}),r?Object(O.jsx)(p.a,{onSubmit:function(t){t.preventDefault(),e({title:o.value,link:l.value}),o.onSubmit(),l.onSubmit(),i(!r)},children:Object(O.jsxs)(p.a.Group,{children:[Object(O.jsx)(p.a.Label,{children:"title:"}),Object(O.jsx)(p.a.Control,Object(j.a)({},o)),Object(O.jsx)("br",{}),Object(O.jsx)(p.a.Label,{children:"link:"}),Object(O.jsx)(p.a.Control,Object(j.a)({},l)),Object(O.jsx)("br",{}),Object(O.jsx)(h.a,{type:"submit",children:"Add"})]})}):null]})},v=function(t){var e=t.message;return Object(O.jsx)("div",{children:e?Object(O.jsx)("h3",{children:e}):null})},m=function(t){var e=t.data,n=t.vis,c=e.reduce((function(t,e){return t+e.chapter}),0),a=e.length,r=e.filter((function(t){return"finished"===t.status})).length,i=e.filter((function(t){return"reading"===t.status})).length;return Object(O.jsx)("div",{children:n?Object(O.jsxs)("div",{children:[Object(O.jsxs)("p",{children:["Chapters read: ",c]}),Object(O.jsxs)("p",{children:["Mangas in collection: ",a]}),Object(O.jsxs)("p",{children:["Mangas finished: ",r]}),Object(O.jsxs)("p",{children:["Mangas current reading: ",i]})]}):null})},S=function(t){var e=t.setSorter,n=t.sorter;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("label",{children:"Sort by:"}),Object(O.jsxs)("select",{value:n,onChange:function(t){t.preventDefault(),e(t.target.value)},children:[Object(O.jsx)("option",{value:"timedes",children:"Time descending"}),Object(O.jsx)("option",{value:"timeasc",children:"Time ascending"}),Object(O.jsx)("option",{value:"namedes",children:"Name descending"}),Object(O.jsx)("option",{value:"nameasc",children:"Name ascending"})]})]})},C=function(t,e,n){switch(t){case"timedes":return new Date(n.lastRead).getTime()-new Date(e.lastRead).getTime();case"timeasc":return new Date(e.lastRead).getTime()-new Date(n.lastRead).getTime();case"namedes":return e.title.toUpperCase()===n.title.toUpperCase()?0:n.title.toUpperCase()>e.title.toUpperCase()?1:-1;case"nameasc":return e.title.toUpperCase()===n.title.toUpperCase()?0:e.title.toUpperCase()>n.title.toUpperCase()?1:-1}},k=n(68),w=0,y={textAlign:"center"},U=function(){var t=Object(c.useState)([]),e=Object(s.a)(t,2),n=e[0],a=e[1],r=Object(c.useState)("reading"),i=Object(s.a)(r,2),o=i[0],j=i[1],u=Object(c.useState)(""),b=Object(s.a)(u,2),x=b[0],p=b[1],U=Object(c.useState)("timedes"),D=Object(s.a)(U,2),T=D[0],I=D[1],L=Object(c.useState)(!1),A=Object(s.a)(L,2),M=A[0],N=A[1],E=d();Object(c.useEffect)((function(){var t=d();l.a.get("http://localhost:3001/api/manga",t).then((function(t){a(t.data)}))}),[o,x]);var F=function(t){clearTimeout(w),w=setTimeout((function(){p("")}),2500),p(t)};return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{children:[Object(O.jsx)("button",{onClick:function(){return j("reading")},children:"Reading"}),Object(O.jsx)("button",{onClick:function(){return j("to start")},children:"To start"}),Object(O.jsx)("button",{onClick:function(){return j("finished")},children:"Finished"}),Object(O.jsx)("button",{onClick:function(){return j("on hold")},children:"On hold"}),Object(O.jsx)("button",{onClick:function(){return j("")},children:"All"}),"\xa0 currently viewing: \xa0 ",o||"All"]}),Object(O.jsx)(k.a,{children:Object(O.jsxs)("tbody",{children:[Object(O.jsxs)("tr",{style:y,children:[Object(O.jsx)("th",{children:Object(O.jsx)("h3",{children:"Title"})}),Object(O.jsx)("th",{children:Object(O.jsx)("h3",{children:"Last Read"})}),Object(O.jsx)("th",{children:Object(O.jsx)("h3",{children:"Current"})}),Object(O.jsx)("th",{children:"Link"}),Object(O.jsx)("th",{children:"Notes"}),Object(O.jsx)("th",{children:"Status"})]}),n.filter((function(t){return t.status.includes(o)})).sort((function(t,e){return C(T,t,e)})).map((function(t){return Object(O.jsx)(f,{manga:t,alert:function(t){return F(t)}},t._id)}))]})})]}),Object(O.jsxs)("div",{children:[Object(O.jsx)(g,{add:function(t){l.a.post("http://localhost:3001/api/manga",t,E).then((function(e){a(e.data),F("Added new manga ".concat(t.title))}))}}),Object(O.jsx)(v,{message:x}),Object(O.jsx)(h.a,{onClick:function(){return N(!M)},children:M?"Hide Stats":"Show Stats"}),Object(O.jsx)(m,{data:n,vis:M}),Object(O.jsx)(S,{setSorter:I,sorter:T})]})]})},D=n(18),T=n.n(D),I=n(31),L=n(11),A=function(t){var e=t.onLogin,n=u("text"),c=u("password"),a=function(){var t=Object(I.a)(T.a.mark((function t(a){var r;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,L.post("http://localhost:3001/api/login",{username:n.value,password:c.value});case 4:r=t.sent,window.localStorage.setItem("loggedInUser",JSON.stringify(r.data)),e(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(a);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}();return Object(O.jsxs)("div",{className:"container",children:[Object(O.jsx)("h2",{children:"Login"}),Object(O.jsx)(p.a,{onSubmit:a,children:Object(O.jsxs)(p.a.Group,{children:[Object(O.jsx)(p.a.Label,{children:"Username"}),Object(O.jsx)(p.a.Control,Object(j.a)({},n)),Object(O.jsx)("br",{}),Object(O.jsx)(p.a.Label,{children:"Password"}),Object(O.jsx)(p.a.Control,Object(j.a)({},c)),Object(O.jsx)("br",{}),Object(O.jsx)(h.a,{type:"submit",children:"Login"})]})})]})},M=function(){var t=Object(c.useState)("loading..."),e=Object(s.a)(t,2),n=e[0],a=e[1];Object(c.useEffect)((function(){try{var t=localStorage.getItem("loggedInUser"),e={headers:{Authorization:"bearer ".concat(JSON.parse(t).token)}};l.a.get("http://localhost:3001/api/users/verify",e).then((function(e){"valid"===e.data?a(JSON.parse(t)):a(null)})).catch((function(t){a(null)}))}catch(n){a(null)}}),[]);return Object(O.jsx)(O.Fragment,{children:n?"loading..."===n?Object(O.jsx)("p",{children:n}):Object(O.jsxs)("div",{className:"container",children:[Object(O.jsx)("h1",{children:"Manga Tracker"}),Object(O.jsxs)("p",{children:["Logged in as 'user name' ",Object(O.jsx)(h.a,{onClick:function(){return localStorage.removeItem("loggedInUser"),void a(null)},children:"logout"})]}),Object(O.jsx)(U,{})]}):Object(O.jsx)(A,{onLogin:function(){var t=localStorage.getItem("loggedInUser");t&&a(JSON.parse(t))}})})};r.a.render(Object(O.jsx)(i.a,{children:Object(O.jsx)(M,{})}),document.getElementById("root"))}},[[67,1,2]]]);
//# sourceMappingURL=main.7a8bac97.chunk.js.map