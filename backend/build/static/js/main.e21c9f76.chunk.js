(this["webpackJsonpmanga-tracker"]=this["webpackJsonpmanga-tracker"]||[]).push([[0],{57:function(t,e,n){"use strict";n.r(e);var c=n(1),a=n(21),r=n.n(a),i=n(24),o=n(3),s=n(6),l=n.n(s),u=n(2),j=function(t){var e=Object(c.useState)(""),n=Object(o.a)(e,2),a=n[0],r=n[1];return{type:t,value:a,onChange:function(t){r(t.target.value)},onSubmit:function(){r("")}}},d=function(){var t=JSON.parse(localStorage.getItem("loggedInUser"));return{headers:{Authorization:"bearer ".concat(t.token)}}},b=function(t){var e=new Date,n=new Date(t).getTime(),c=(e.getTime()-n)/1e3;return c<60?"just now":c<3600?"".concat(Math.floor(c/60)," minute(s) ago"):c<86400?"".concat(Math.floor(c/3600)," hour(s) ago"):c<2592e3?"".concat(Math.floor(c/86400)," day(s) ago"):c<31104e3?"".concat(Math.floor(c/2592e3)," month(s) ago"):"".concat(Math.floor(c/31104e3)," year(s) ago")},h=n(0),O={textAlign:"center"},x=function(t){var e=Object(c.useState)(""),n=Object(o.a)(e,2),a=n[0],r=n[1],i=Object(c.useState)(!1),s=Object(o.a)(i,2),x=s[0],f=s[1],g=j("text"),p="http://localhost:3001/api/manga";Object(c.useEffect)((function(){r(a||t.manga)}),[t,a]);var v=d(),m=function(e){if(e.preventDefault(),"<"===e.target.outerText){var n=Object(u.a)(Object(u.a)({},a),{},{chapter:a.chapter-=1});r(n),l.a.put(p,n,v).then((function(e){r(e.data),t.alert("".concat(e.data.title," moved to previous chapter"))})).catch((function(e){t.alert("Error: ".concat(e))}))}else if(">"===e.target.outerText){var c=Object(u.a)(Object(u.a)({},a),{},{chapter:a.chapter+=1,lastRead:new Date});r(c),l.a.put(p,c,v).then((function(e){r(e.data),t.alert("".concat(e.data.title," moved to next chapter"))})).catch((function(e){t.alert("Error: ".concat(e))}))}},S=function(t){t.preventDefault(),f(!x)};return Object(h.jsxs)("tr",{style:O,children:[Object(h.jsx)("td",{children:a.title||"none"}),Object(h.jsx)("td",{children:b(a.lastRead)}),Object(h.jsxs)("td",{children:[Object(h.jsx)("button",{onClick:m,children:"<"}),"\xa0",a.chapter,"\xa0",Object(h.jsx)("button",{onClick:m,children:">"})]}),Object(h.jsx)("td",{children:x?Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=Object(u.a)(Object(u.a)({},a),{},{link:g.value});l.a.put(p,n,v).then((function(t){r(t.data),g.onSubmit(),f(!x)})).catch((function(e){t.alert("Error: ".concat(e))}))},children:["link: ",Object(h.jsx)("input",Object(u.a)({},g)),Object(h.jsx)("button",{type:"submit",children:"Update"}),Object(h.jsx)("button",{onClick:S,children:"Cancel"})]})}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("a",{href:String(a.link),children:"Go"}),Object(h.jsx)("button",{onClick:S,children:"Update"})]})}),Object(h.jsx)("td",{children:Object(h.jsxs)("select",{onChange:function(e){if(e.preventDefault(),window.confirm("Are you sure you want to mark ".concat(a.title," as ").concat(e.target.value))){var n=Object(u.a)(Object(u.a)({},a),{},{status:e.target.value});l.a.put(p,n,v).then((function(n){r(n.data),t.alert("Setting ".concat(a.title," status to ").concat(e.target.value))})).catch((function(e){t.alert("Error: ".concat(e))}))}},children:[Object(h.jsx)("option",{value:a.status,children:a.status}),"reading"===a.status?null:Object(h.jsx)("option",{value:"reading",children:"reading"}),"finished"===a.status?null:Object(h.jsx)("option",{value:"finished",children:"finished"}),"to start"===a.status?null:Object(h.jsx)("option",{value:"to start",children:"to start"}),"on hold"===a.status?null:Object(h.jsx)("option",{value:"on hold",children:"on hold"})]})}),Object(h.jsx)("td",{})]})},f=function(t){var e=t.add,n=Object(c.useState)(!1),a=Object(o.a)(n,2),r=a[0],i=a[1],s=j("text"),l=j("text"),d=function(){return Object(h.jsx)("button",{onClick:function(t){t.preventDefault(),i(!r)},style:{height:"25px",width:"90px"},children:r?"Close":"Add Manga"})};return Object(h.jsxs)("div",{children:[Object(h.jsx)(d,{}),r?Object(h.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e({title:s.value,link:l.value}),s.onSubmit(),l.onSubmit(),i(!r)},children:["title:",Object(h.jsx)("input",Object(u.a)({},s)),Object(h.jsx)("br",{}),"link:",Object(h.jsx)("input",Object(u.a)({},l)),Object(h.jsx)("button",{type:"submit",children:"Add"})]}):null]})},g=function(t){var e=t.message;return Object(h.jsx)("div",{children:e?Object(h.jsx)("h3",{children:e}):null})},p=function(t){var e=t.data,n=Object(c.useState)(!1),a=Object(o.a)(n,2),r=a[0],i=a[1],s=e.reduce((function(t,e){return t+e.chapter}),0),l=e.length,u=e.filter((function(t){return"finished"===t.status})).length,j=e.filter((function(t){return"reading"===t.status})).length;return Object(h.jsxs)("div",{children:[Object(h.jsx)("button",{onClick:function(){return i(!r)},children:r?"Hide Stats":"Show Stats"}),r?Object(h.jsxs)("div",{children:[Object(h.jsxs)("p",{children:["Chapters read: ",s]}),Object(h.jsxs)("p",{children:["Mangas in collection: ",l]}),Object(h.jsxs)("p",{children:["Mangas finished: ",u]}),Object(h.jsxs)("p",{children:["Mangas current reading: ",j]})]}):null]})},v=0,m=function(){var t=Object(c.useState)([]),e=Object(o.a)(t,2),n=e[0],a=e[1],r=Object(c.useState)("reading"),i=Object(o.a)(r,2),s=i[0],u=i[1],j=Object(c.useState)(""),b=Object(o.a)(j,2),O=b[0],m=b[1],S=d();Object(c.useEffect)((function(){var t=d();l.a.get("http://localhost:3001/api/manga",t).then((function(t){a(t.data)}))}),[s,O]);var k=function(t){clearTimeout(v),v=setTimeout((function(){m("")}),2500),m(t)};return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("button",{onClick:function(){return u("reading")},children:"Reading"}),Object(h.jsx)("button",{onClick:function(){return u("to start")},children:"To start"}),Object(h.jsx)("button",{onClick:function(){return u("finished")},children:"Finished"}),Object(h.jsx)("button",{onClick:function(){return u("on hold")},children:"On hold"}),Object(h.jsx)("button",{onClick:function(){return u("")},children:"All"}),"\xa0 currently viewing: \xa0 ",s||"All"]}),Object(h.jsx)("table",{width:"80%",children:Object(h.jsxs)("tbody",{children:[Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:Object(h.jsx)("h3",{children:"Title"})}),Object(h.jsx)("th",{children:Object(h.jsx)("h3",{children:"Last Read"})}),Object(h.jsx)("th",{children:Object(h.jsx)("h3",{children:"Current"})}),Object(h.jsx)("th",{children:"Link"}),Object(h.jsx)("th",{children:"Status"})]}),n.filter((function(t){return t.status.includes(s)})).sort((function(t,e){return new Date(e.lastRead).getTime()-new Date(t.lastRead).getTime()})).map((function(t){return Object(h.jsx)(x,{manga:t,alert:function(t){return k(t)}},t._id)}))]})})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("br",{}),Object(h.jsx)(f,{add:function(t){l.a.post("http://localhost:3001/api/manga",t,S).then((function(e){a(e.data),k("Added new manga ".concat(t.title))}))}}),Object(h.jsx)(g,{message:O}),Object(h.jsx)(p,{data:n})]})]})},S=n(10),k=n.n(S),w=n(22),C=n(6),y=function(t){var e=t.onLogin,n=j("text"),c=j("password"),a=function(){var t=Object(w.a)(k.a.mark((function t(a){var r;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,C.post("http://localhost:3001/api/login",{username:n.value,password:c.value});case 4:r=t.sent,window.localStorage.setItem("loggedInUser",JSON.stringify(r.data)),e(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(a);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}();return Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"Login"}),Object(h.jsxs)("form",{onSubmit:a,children:["username:",Object(h.jsx)("input",Object(u.a)({},n)),Object(h.jsx)("br",{}),"password:",Object(h.jsx)("input",Object(u.a)({},c)),Object(h.jsx)("br",{}),Object(h.jsx)("button",{type:"submit",children:"Login"})]})]})},D=function(){var t=Object(c.useState)("loading..."),e=Object(o.a)(t,2),n=e[0],a=e[1];Object(c.useEffect)((function(){try{var t=localStorage.getItem("loggedInUser"),e={headers:{Authorization:"bearer ".concat(JSON.parse(t).token)}};l.a.get("http://localhost:3001/api/users/verify",e).then((function(e){"valid"===e.data?a(JSON.parse(t)):a(null)})).catch((function(t){a(null)}))}catch(n){a(null)}}),[]);return Object(h.jsx)(h.Fragment,{children:n?"loading..."===n?Object(h.jsx)("p",{children:n}):Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"Manga Tracker"}),Object(h.jsxs)("p",{children:["Logged in as 'user name' ",Object(h.jsx)("button",{onClick:function(){return localStorage.removeItem("loggedInUser"),void a(null)},children:"logout"})]}),Object(h.jsx)(m,{})]}):Object(h.jsx)(y,{onLogin:function(){var t=localStorage.getItem("loggedInUser");t&&a(JSON.parse(t))}})})};r.a.render(Object(h.jsx)(i.a,{children:Object(h.jsx)(D,{})}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.e21c9f76.chunk.js.map